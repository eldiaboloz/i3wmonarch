#!/bin/bash
# https://www.reddit.com/r/unixporn/comments/3358vu/i3lock_unixpornworthy_lock_screen
icon="$HOME/.xlock/icon.png"
tmpbg='/tmp/screen.png'
scrot "$tmpbg"
convert "$tmpbg" -scale 20% -scale 500% "$tmpbg"
convert "$tmpbg" "$icon" -geometry +960+540 -composite -matte "$tmpbg" 
convert "$tmpbg" "$icon" -geometry +2880+540 -composite -matte "$tmpbg" 
cmusdata=`cmus-remote -Q`
if [ $? -eq 0 ]; then
	curmode=$(echo "$cmusdata" | sed -n 1p | cut -d ' ' -f2-)
	if [ "$curmode" = "playing" ]; then
		cmus-remote --pause
	fi
fi
~/dev/i3wmonarch/github.com/nonpop/xkblayout-state/xkblayout-state set 0
i3lock -i "$tmpbg"

sleep 1; xset dpms force off
